#비주얼 스튜디오를 사용해주세요 파이썬으로 그리고  pip install pillow 설치해야함
#단계 1 왼쪽  explorer 창에 "convert.py" 코드창 을 만든다
#단계 2 원하는 사진을 구하여 사진이름은 real_test.jpg.webp 로 바꾼다 혹은 A.webp 라고 하고 아래 인풋문 파일도 A.webp라고 하면 됨 그후 바탕화면이나 파일에 저장
#단게 3 다운로드 한 파일을 잡아서 파이썬 explorer 창으로 옮긴다. 잘 됬을경우 : 아이콘은 보라색 사진으로 나오고 누르면 사진이 보임  , 잘 안된경우 : 사진을 누르니 에러가 남  ,  원인: webp를 붙여야함  jpg는 아님
#단계 4 왼쪽 이미지 이름과 convert.py쏙 인풋 파일의 이름이 같을 경우 실행 시키면 explorer창에 bin 파일이 생김
#단계 5 그 bin 파일을 SD카드 가 담긴 USB 파일에 넣는다   +  USB를 포맷시킨 상태로 한다 . 포맷 방법: USB 드라이브 우클릭 우 포맷 클릭 
#단계 6 bin 파일이 담긴 sd카드를 usb에서 뽑아 ili9225 뒷면에 삽입 한다

from PIL import Image
import struct
import os

# --- 설정 부분 (여기만 정확하면 됩니다) ---
input_file = 'real_test.jpg.webp'  # 익스플로러에 보이는 이름 그대로!
output_file = 'image.bin' 
# -------------------------------------

def convert_now():
    try:
        # 1. 사진 열기 (Pillow는 webp도 지원합니다!)
        img = Image.open(input_file)
        print(f"파일을 찾았습니다: {input_file}")
        
        # 2. 강제로 176x220 크기로 맞추기
        img = img.resize((176, 220), Image.Resampling.LANCZOS)
        img = img.convert('RGB')
        
        # 3. 데이터 변환 및 저장
        with open(output_file, 'wb') as f:
            for y in range(220):
                for x in range(176):
                    r, g, b = img.getpixel((x, y))
                    # RGB888 -> RGB565 변환
                    rgb = ((r & 0xF8) << 8) | ((g & 0xFC) << 3) | (b >> 3)
                    f.write(struct.pack('>H', rgb))
                    
        print(f"--- [대성공!] '{output_file}' 파일이 생성되었습니다. ---")
        
    except Exception as e:
        print(f"에러 발생: {e}")
        print("팁: 왼쪽 창에 파일 이름이 'real_test.jpg.webp'가 맞는지 다시 확인해보세요!")

convert_now()
